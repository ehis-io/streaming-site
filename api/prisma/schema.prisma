generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Movie {
  id          String     @id @default(auto()) @map("_id") @db.ObjectId
  tmdbId      Int        @unique
  title       String
  type        String     // "movie" or "tv"
  providers   Provider[]
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
}

model Provider {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  movieId     String   @db.ObjectId
  movie       Movie    @relation(fields: [movieId], references: [id])
  name        String   // "YouTube", "Vimeo", etc.
  embedUrl    String
  priority    Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Anime {
  id          String          @id @default(auto()) @map("_id") @db.ObjectId
  malId       Int             @unique
  title       String
  providers   AnimeProvider[]
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt
}

model AnimeProvider {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  animeId     String   @db.ObjectId
  anime       Anime    @relation(fields: [animeId], references: [id])
  name        String
  embedUrl    String
  priority    Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

